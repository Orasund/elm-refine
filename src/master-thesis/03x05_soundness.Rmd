\setcounter{section}{3}
\setcounter{subsection}{4}

## Soundness

In this section we want to prove the soundness of the inference rules with respect to the semantics. This means we want to ensure that a if we can infer the type of a program, the program has also got a semantic.

### Soundness of the type signiture signiture

The inference rules and the semantics for the type signitures are build structually similar therefore we can easily show their equivalance.

```{theorem}
\begin{letIn}
$\Gamma$ be a type context, $\mathit{ltf}\in\mf{<list-type-fields>}$, $a_i\in\mathcal{V}$,$T_i\in\mathcal{T}$ for $i\in\mathbb{N}_1^n$ and $n\in\mathbb{N}_0$.
\end{letIn}
The Judgment $\Gamma\vdash \mathit{ltf}:\{a_1:T_1,\dots,a_n:T_n\}$ can be derived if and only if \(\semantic{$\mathit{lft}$}_\Gamma = \{a_1:T_1,\dots,a_n:T_n\}\).
```
```{proof}
$\Gamma$ be a type context.
\begin{itemize}
    \item \textbf{Case} $ltf = \mf{""}$: Then $\Gamma\vdash ltf:\{ \ \}$ and \(\semantic{$\mathit{lft}$}_\Gamma=\{ \ \}\).
    \item \textbf{Case} $lft = a_0 \ \mf{":"} \ T_0 \ \mf{","} \ lft_1$ for given $a_0\in\mathcal{V}$, $T_0\in\mathcal{T}$ and $\mathit{ltf}_1\in\mf{<list-type-field>}$ where $\Gamma\vdash \mathit{ltf}_1:\{a_1:T_1,\dots,a_n:T_n\}$ and \(\semantic{$\mathit{ltf}_1$}_\Gamma=\{a_1:T_1,\dots,a_n:T_n\}\) for given $T_i\in\mathcal{T},a_i\in\mathcal{V}$ and $i\in\mathbb{N}_1^n, n\in\mathbb{N}_0$:\\
    Then $\Gamma\vdash \mathit{lft} : \{a_0 : T_0,a_1 : T_1\dots a_n:T_n \}$ and \(\semantic{$\mathit{ltf}$}_\Gamma = \{a_0 : T_0,a_1 : T_1\dots a_n:T_n \}\).
  \end{itemize}
```

```{theorem}
\begin{letIn}
$\Gamma$ be a type context, $T_i\in\mathcal{T}$ for $i\in\mathbb{N}_1^n$ and $n\in\mathbb{N}_0$.
\end{letIn}
The Judgment $\Gamma\vdash\mathit{lt}:(T_1,\dots,T_n)$ can be derived if and only if \(\semantic{$\mathit{lt}$}=(T_1,\dots,T_n)\).
```
```{proof}
$\Gamma$ be a type context.
\begin{itemize}
  \item \textbf{Case} $l = \mf{""}$: then $\Gamma\vdash l:()$ and \(\semantic{$l$}_\Gamma = ()\).
  \item \textbf{Case} $l = \ t_0 \ l_1$ for $l_1\in\mf{<list-type>}$ that $\Gamma\vdash l_1:(T_1,\dots,T_n)$ where $T_i\in\mathcal{T}$,$i\in\mathbb{N}_1^n$ and $n\in\mathbb{N}_0$, $t_0\in\mf{<type>}$ such that $\Gamma\vdash t_0 : T_0$ and \(\semantic{$t_0$}_\Gamma=T_0\) and $T_0\in\mathcal{T}$:\\
  Then $\Gamma\vdash l : (T_0,T_1,\dots,T_n)$.
\end{itemize}
```

```{theorem}
\begin{letIn}
$\Gamma$ be a type context, $t \in\mf{<type>}$ and $T\in\mathcal{T}$. 
\end{letIn}
The Judgment $\Gamma\vdash t:T$ can be derived if and only if \(\semantic{$t$}_\Gamma = T\).
```
```{proof}
Let $\Gamma$ be a type context, $t \in\mf{<type>}$ and $T\in\mathcal{T}$.
\begin{itemize}
\item\textbf{Case} $t = \mf{"Bool"}$: Then $\Gamma\vdash t:\mathit{Bool}$ and \(\semantic{$t$}_\Gamma = \mathit{Bool}\).
\item\textbf{Case} $t = \mf{"Int"}$: Then $\Gamma\vdash t:\mathit{Int}$ and \(\semantic{$t$}_\Gamma = \mathit{Int}\).
\item\textbf{Case} $t = \mf{"List"} \ t_2$, for $t_2\in\mf{<type>}$: By induction hypothesis, assume $\Gamma\vdash t_2:T_2$ and \(\semantic{$t_2$}_\Gamma = T_2\) for given $T_2\in\mathcal{T}$. Then $\Gamma\vdash t:\mathit{List} \ T_2$ and \(\semantic{$t$}_\Gamma = \mathit{List} \ T_2\).
\item\textbf{Case} $t = \mf{"("} \ t_1 \mf{","} t_2 \ \mf{")"}$, for $t_1,t_2\in\mf{<type>}$: By induction hypothesis, assume $\Gamma\vdash t_1:T_1$ and $\Gamma\vdash t_2:T_2$ for given $T_1,T_2\in\mathcal{T}$. Then $\Gamma\vdash t:(T_1,T_2)$ and \(\semantic{$t$}_\Gamma = (T_1,T_2)\).
\item\textbf{Case} $t = \mf{"\{"} \ \mathit{ltf} \ \mf{"\}"}$, for $\mathit{ltf}\in\mf{<list-type-field>}$: Then $\Gamma\vdash \mathit{ltf}:T$ and \(\semantic{$\mathit{ltf}$}_\Gamma = T\) for $T=\{a_1:T_1,\dots,a_n:T_n\}$, $a_i\in\mathcal{V}$,$T_i\in\mathcal{T}$ for $i\in\mathbb{N}_1^n$ and $n\in\mathbb{N}_0$. Therefore $\Gamma\vdash t : T$ and \(\semantic{$t$}_\Gamma= T\).
\item\textbf{Case} $t = t_1 \ \mf{"->"} \ t_2$, for $t_1,t_2\in\mf{<type>}$: By induction hypothesis, assume $\Gamma\vdash t_i:T_i$ and \(\semantic{$t_i$}_\Gamma = T_i\) for $i\in\{1,2\}$ and given $T_1,T_2\in\mathcal{T}$. Then $\Gamma\vdash t:T_1 \rightarrow T_2$ and \(\semantic{$t$}_\Gamma = T_1 \rightarrow T_2\).
\item\textbf{Case} $t = c \ l$ for $l\in\mf{<list-type>}$ and $c\in\mf{<upper-var>}$ with $(c,T')\in\Gamma$ with $T'\in\mathcal{T}$: Then $\Gamma\vdash l:(T_0,\dots,T_n)$ and \(\semantic{$l$}_\Gamma=(T_1,\dots,T_n)\) for $T_i\in\mathcal{T}$,$i\in\mathbb{N}^n$ and $n\in\mathbb{N}_0$. Then $\Gamma\vdash t:\overline{T'} \ T_1 \ \dots \ T_n$ and \(\semantic{$t$}_\Gamma =\overline{T'} \ T_1 \ \dots \ T_n\), where $\overline{T'}$ represents the application constructor of $T'$
\item\textbf{Case} $t = a$ for $a\in\mathcal{V}$: Then $\Gamma\vdash t:\forall \ b . b$ and \(\semantic{$t$}_\Gamma = \forall \ b . b\).
\end{itemize}
```

### Soundness of the variable context

In our previous sections we had two different meanings for $\Delta$. We now want to show, that these two definitions correlate.

```{definition,name="Well formed variable context"}
\begin{letIn}
$\Gamma,\Delta$ be type contexts and $\Delta'$ a variable context.
\end{letIn}

We say $\Delta'$ is \textit{well defined with respect to} $\Delta :\Leftrightarrow$
  
\[ \forall T \in\mathcal{T}.\forall a \in\mathcal{V}. (a,T) \in \Delta \Rightarrow \exists e \in \text{value}_\Gamma(T). (a,e) \in \Delta'.\]
```

We will now show that our semantic ensures that all used variable contexts are well formed.

//Todo

### Soundness of the Expression Semantic

We can now use the definition of well formed variable contexts, to proof the soundness of the expression semantics.

```{theorem}
\begin{letIn}
$\Gamma$,$\Delta$ be type contexts, $\Delta'$ be a well formed variable context with respect to $\Delta$ and $\mathit{lef}\in\mf{<list-exp-field>}$.
Let the judgment $\Gamma,\Delta\vdash\mathit{lef}:T$ hold for $T=\{a_1:T_1,\dots,a_n:T_n\}\in\mathcal{T}$, $a_i\in\mathcal{V},T_i\in\mathcal{T}$, given $i\in\mathbb{N}_1^n$ and $n\in\mathbb{N}_0$.
\end{letIn}
Then \(\semantic{$\mathit{lef}$}_{\Gamma,Delta'}\in\text{value}_\Gamma(T)\) .
```
```{proof}
Let $\Gamma$,$\Delta$ be type contexts, $\Delta'$ be a well formed variable context with respect to $\Delta$ and $\mathit{lef}\in\mf{<list-exp-field>}$.
Let the judgment $\Gamma,\Delta\vdash\mathit{lef}:T$ hold for $T=\{a_1:T_1,\dots,a_n:T_n\}\in\mathcal{T}$, $a_i\in\mathcal{V},T_i\in\mathcal{T}$, given $i\in\mathbb{N}_1^n$ and $n\in\mathbb{N}_0$.

\begin{itemize}
\item\textbf{Case} $\mathit{lef}=a_1 \ \mf{"="} \ e$ for $e\in\mf{<type>}$ and $n = 1$: Then $\Gamma,\Delta\vdash e:T_1$ and therfore \(\semantic{$e$}_{\Gamma,\Delta'}\in\text{value}_\Gamma(T)\). Thus the assumption holds.
\item\textbf{Case} $\mathit{lef}=a_1 \ \mf{"="} \ e \ \mf{","} \ \mathit{lef}_0$ for $e\in\mf{<type>}$ and $lef_0\in\mf{<list-exp-field>}$: Then $\Gamma,\Delta\vdash \mathit{lef}_0:T$,$\Gamma,\Delta\vdash e: T_1$ and therefore \(\semantic{$e$}_{\Gamma,\Delta'}\in\text{value}_\Gamma(T_1)\) and by induction hypothesis \(\semantic{$lef_0$}_{\Gamma,\Delta'}\in\text{value}_\Gamma(\{a_2:T_2,\dots,a_n:T_n\})\). Thus the assumption holds.
\end{itemize}
```

```{theorem}
\begin{letIn}
$\mathit{mes}\in\mf{<maybe-exp-sign>}$. 
\end{letIn}
Then \(\semantic{$\mathit{mes}$}=()\).
```
```{proof}
//Todo
```

```{theorem}
\begin{letIn}
$b\in\mf{<bool>}.$ Let $b:\mathit{Bool}$.
\end{letIn}
 Then \(\semantic{$b$}\in\text{value}_\varnothing(\mathit{Bool})\).
```
```{proof}
//Todo
```

```{theorem}
\begin{letIn}
$i\in\mf{<int>}$. Let $i:\mathit{Int}$. 
\end{letIn}
Then \(\semantic{$i$}\in\text{value}_\varnothing(\mathit{Int})\).
```
```{proof}
//Todo
```

```{theorem}
\begin{letIn}
$\Gamma,\Delta$ be type contexts, $\Delta'$ be a well formed variable context with respect to $\Delta$ and $\mathit{le}\in\mf{<list-exp>}$. Let $\Gamma,\Delta\vdash\mathit{le}:\mathit{List} \ T$ for $T\in\mathcal{T}$.
\end{letIn}
Then \(\semantic{$\mathit{le}$}_{\Gamma,\Delta'}\in\text{value}_\Gamma(\mathit{List} \ T)\).
```
```{proof}
//Todo
```

```{theorem}
\begin{letIn}
$\Gamma,\Delta$ be type contexts, $\Delta'$ be a well formed variale context with respect to $\Delta$. Let $e\in\mf{<exp>}$ and $T\in\mathcal{T}$. Let $\Delta,\Gamma\vdash e:T$ be valid.
\end{letIn}
Then \(\semantic{$e$}_{\Gamma,\Delta'}\in\text{value}_\Gamma(T)\).
```
```{proof}
//Todo
```

### Soundness of the Statement Semantic

Statements are modeled as operations on either the type context or the variable context. We will now show that their definitions described in the semantics are the same as the definition in the inference rules.

```{theorem}
\begin{letIn}
$\mathit{lsv}\in\mf{<list-statement-var>}$, $a_i\in\mathbb{N}_1^n$ for $n\in\mathbb{N}_0$. Let $\mathit{lsv}:(a_1,\dots,a_n)$ hold.
\end{letIn}
Then \(\semantic{lsv}\in\mathcal{V}*\).
```
```{proof}
//Todo
```

```{theorem}
\begin{letIn}
$\Gamma_1,\Delta_1,\Gamma_2,\Delta_2$ be type contexts and $\Delta_1',\Delta_2'$ be well formed variable contexts with respect to $\Delta_1$ and $\Delta_2$ respectively. Let $ls\in\mf{<list-statement>}$ such that $\Gamma_1,\Delta_1,\mathit{ls}\vdash\Gamma_2,\Delta_2$ holds.
\end{letIn}
Then \(\semantic{$\mathit{ls}$}(\Gamma_1,\Delta_1') = (\Gamma_2,\Delta_2')\).
```
```{proof}
//Todo
```

```{theorem}
\begin{letIn}
$\Gamma$ be a type context, $\mathit{mss}\in\mf{<maybe-statement-sign>},a\in\mathcal{V},T\in\mathcal{T}$. Let $\Gamma,\mathit{mss}\vdash a:T$ hold.
\end{letIn}
Then \(\semantic{$\mathit{mss}$}=()\).
```
```{proof}
//Todo
```

```{theorem}
\begin{letIn}
$\Gamma_1,\Gamma_2,\Delta_1,\Delta_2$ be type contexts and $\Delta_1',\Delta_2'$ be well defined variable contexts with respect to $\Delta_1,\Delta_2$. Let $s\in\mf{<statement>}$ and $\Gamma_1,\Delta_1,s\vdash\Gamma_2,\Delta_2$ hold.
\end{letIn}
Then \(\semantic{$s$}(\Gamma_1,\Delta_1') = (\Gamma_2,\Delta_2')\).
```
```{proof}
//Todo
```

### Soundness of the Program Semantic

A program is a sequence of statements. Starting with an empty type context, and an empty variable context, one statement at the time will be applied, resulting in a value $e$, a type $T$ and a type context $\Gamma$ such that $e\in\text{value}_\Gamma(T)$.

```{theorem}
\begin{letIn}
$\Gamma$ be a type context, $\mathit{mms}\in\mf{<maybe-main-sign>}$ and $T\in\mathcal{T}$ such that $\Gamma,\mathit{mms}\vdash \mf{main} : T$ holds.
\end{letIn}
Then \(\semantic{$\mathit{mms}$}=()\).
```
```{proof}
//Todo
```

```{theorem}
\begin{letIn}
$p\in\mf{<program>}$ and $T\in\mathcal{T}$ such that $p:T$.
\end{letIn}

Then there exists a type context $\Gamma$ such that \(\semantic{$p$}\in\text{value}_\Gamma(T)\).
```
```{proof}
//Todo
```




