%%
%% subsubsections
%%
\renewcommand{\paragraph}[1]{
  \rule{4cm}{0.4pt}\newline
    {\footnotesize\textbf{\MakeUppercase{{#1}}}}~\nolinebreak[4]
}

\newenvironment{myexample}[2][]{\begin{example}}{\end{example}}

\iftrue
%%
%% example
%%
\providecounter{example}[section]\setcounter{example}{0} %%defined the counter
\providecommand{\theexample}{}
\renewcommand{\theexample}{\arabic{section}.\arabic{example}}
\renewenvironment{myexample}[2][]
  {\refstepcounter{example}
  \mdfsetup{frametitlefont=\normalfont,
    topline=false,
    bottomline=false,
    rightline=false,
    linecolor=green!20,
    linewidth=2pt,
    skipabove=12,
    %needspace=4\baselineskip,
    innertopmargin=1.2\baselineskip,
    singleextra={
      \node[
        overlay,
        outer sep=0pt,
        right,
        xshift=-1.pt,
        %anchor=north east,
        %text width=2.5cm,
        minimum height=4ex,
        fill=green!20,
      ] at (O|-P)%
      {\strut \textbf{Example~\theexample}};
      },
    firstextra={
      \node[
        overlay,
        outer sep=0pt,
        right,
        xshift=-1pt,
        %anchor=north east,
        %text width=2.5cm,
        minimum height=4ex,
        fill=green!20,
      ] at (O|-P)%
      {\strut \textbf{Example~\theexample}};
      }}
  \vspace{0.2cm}\begin{mdframed}
  }
  {\end{mdframed}}

%%
%% AXIOMS
%%
\newcounter{axiom}[section]\setcounter{axiom}{0}
\renewcommand{\theaxiom}{\arabic{section}.\arabic{axiom}}
\newenvironment{axiom}[2][]{%
  \refstepcounter{axiom}%
  \mdfsetup{%
    singleextra={%
      \node[
        overlay,
        xshift=10pt,
        right,
        outer sep=0pt,
        rectangle,
        fill=yellow!10!orange!20
      ] at (O|-P)
      {\strut \textbf{Axiom~\theaxiom\ifstrempty{#1}{}{:~#1}}
      };
    },
    firstextra={%
      \node[
        overlay,
        xshift=10pt,
        right,
        outer sep=0pt,
        rectangle,
        fill=yellow!10!orange!20
      ] at (O|-P)
      {\strut \textbf{Axiom~\theaxiom\ifstrempty{#1}{}{:~#1}}
      };
    }
  }
  \mdfsetup{
    innertopmargin=1.2\baselineskip,linecolor=yellow!10!orange!20,%
    linewidth=2pt,topline=true,%
    frametitleaboveskip=\dimexpr-\ht\strutbox\relax
  }
  \begin{mdframed}[skipabove=20pt]\relax%
  \label{#2}
}
{\end{mdframed}}


%%
%% DEFINITONS
%%
\newcounter{defi}[section]\setcounter{defi}{0}
\renewcommand{\thedefi}{\arabic{section}.\arabic{defi}}
\provideenvironment{definition}{}{}
\renewenvironment{definition}[2][]{%
  \refstepcounter{defi}%
  \mdfsetup{%
    singleextra={%
      \node[
        overlay,
        xshift=10pt,
        right,
        outer sep=0pt,
        rectangle,
        fill=red!20
      ] at (O|-P)
      {\strut \textbf{Definition~\thedefi\ifstrempty{#1}{}{:~#1}}
      };
    },
    firstextra={%
      \node[
        overlay,
        xshift=10pt,
        right,
        outer sep=0pt,
        rectangle,
        fill=red!20
      ] at (O|-P)
      {\strut \textbf{Definition~\thedefi\ifstrempty{#1}{}{:~#1}}
      };
    }
  }
  \mdfsetup{
    innertopmargin=1.2\baselineskip,linecolor=red!20,%
    linewidth=2pt,topline=true,%
    frametitleaboveskip=\dimexpr-\ht\strutbox\relax
  }
  \begin{mdframed}[skipabove=20pt]\relax%
  \label{#2}
}
{\end{mdframed}}

%%
%% THEOREM
%%
\newcounter{theo}[section]\setcounter{theo}{0}
\renewcommand{\thetheo}{\arabic{section}.\arabic{theo}}
\provideenvironment{theorem}{}{}
\renewenvironment{theorem}[2][]{%
  \refstepcounter{theo}%
  \mdfsetup{%
    singleextra={%
      \node[
        overlay,
        xshift=10pt,
        right,
        outer sep=0pt,
        rectangle,
        fill=blue!20
      ] at (O|-P)
      {\strut \textbf{Theorem~\thetheo\ifstrempty{#1}{}{:~#1}}
      };
    },
    firstextra={%
      \node[
        overlay,
        xshift=10pt,
        right,
        outer sep=0pt,
        rectangle,
        fill=blue!20
      ] at (O|-P)
      {\strut \textbf{Theorem~\thetheo\ifstrempty{#1}{}{:~#1}}
      };
    }
  }
  \mdfsetup{
    innertopmargin=1.2\baselineskip,linecolor=blue!20,%
    linewidth=2pt,topline=true,%
    frametitleaboveskip=\dimexpr-\ht\strutbox\relax
  }
  \begin{mdframed}[skipabove=20pt]\relax%
  \label{#2}
}
{\end{mdframed}}
\fi

\begin{titlepage}
\include{coversheet}
\end{titlepage}


\section*{Zusammenfassung}

Das Ziel dieser Arbeit ist es, das Typensystem von Elm mit sogenannten \enquote{Refinement} Typen zu erweitern. Elm ist eine reine funktionale Programmiersprache welche das Hindley-Miler Typsystem benutzt. Refinement Typen sind eine Form von Subtypen, welche anhand eines Prädikats seine enthaltenen Werte bestimmt. Eine solche Klasse von Refinement Typen welche für Hindely-Miler Typsysteme ausgelegt ist, sind die sogenannten \enquote{Liquid} Typen. Für sie existiert ein Algorithmus, um für einen Ausdruck den dazugehörigen Typ herzuleiten. Dieser Algorithmus interagiert mit einem SMT Solver, um bestimmte Bedingungen für die Subtypen zu erfüllen. Typsysteme welche mit Liquid Typen erweitert werden, sind nicht länger vollständig. Stattdessen können sie nur für bestimmte Ausdrücke hergeleitet werden. Die Prädikate sind ebenfalls restringiert.
Diese Arbeit liefert eine formale Definition von Elm und dessen Typsystem. Außerdem wird das System mit Liquid Typen erweitert. Hierfür wird eine Teilmenge der Ausdrücke sowie eine Teilmenge der Prädikate präsentiert, um die Wohldefiniertheit der Liquid Typen zu gewährleisten. Zum Überprüfen unserer Ergebnisse benützen wir das Softwaresystem \enquote{K Framework} sowie eine Implementierung in Elm des Algorithmus zum Lösen der Bedingungen für Subtypen. Als SMT Sovler benutzen wir Z3.
\newpage

\section*{Abstract}

The aim of this thesis is to add refinement types to Elm. Elm is a pure functional programming language that uses a Hindley-Miler type system. Refinement types are subtypes of existing types. These subtypes are defined by a predicate that specifies which values are part of the subtypes. To extend a Hindley-Miler type system one can use so-called Liquid types. These are special refinement types that come with an algorithm for type inferring. This algorithm interacts with an SMT solver to solve subtyping conditions. A type system using Liquid types is not complete, meaning not every valid program can be checked. Instead, Liquid types are only defined for a subset of expressions and only allow specific predicates.
In this thesis we give a formal definition of the Elm language and its type system. We extend the type system with Liquid types and provide a subset of expressions and a subset of predicates such that the extended type system is sound. We use the software system \enquote{K Framework} for rapid prototyping of the formal Elm type system. For rapid prototyping of the core algorithm of the extended type system we implemented said algorithm in Elm and checked the subtyping condition in the SMT solver Z3.

\newpage

\section*{Eidesstattliche Erklärung}

Ich erkläre an Eides statt, dass ich die vorliegende Masterarbeit selbstständig und ohne fremde Hilfe verfasst, andere als die angegebenen Quellen und Hilfsmittel nicht benutzt bzw. die wörtlich oder sinngemäß entnommenen Stellen als solche kenntlich gemacht habe.
Die vorliegende Masterarbeit ist mit dem elektronisch übermittelten Textdokument identisch.

\vspace*{20mm}


\makebox[.5\linewidth][r]{}\dotsign\smallskip\newline
\hspace*{.5\linewidth}\ Lucas Payr
\newpage

\section*{Thanks}

I would like to thank my supervisor Wolfgang Schreiner for his continuous advice and suggestions throughout numerous revisions. Your input helped a lot.

I would also like to thank my friends and my girlfriend for this lovely time I had at university. I would not have been able to finish my degree if it would not have been without your love and support. It was a great time.

Last but not least, a big thanks to my family. I am privileged to have you all.